{% extends 'userpanel/user_base.html' %}
{% load static %}
{% block title %}
    Blog | MyBlogs
{% endblock %}
{% block content %}

<div class="col-xl-12" style="margin-top: 70px;">
    <h6 class="text-muted"></h6>
    <div class="nav-align-top mb-4">
        <ul class="nav nav-pills mb-3 nav-fill" role="tablist">
            <!-- My Blogs Tab -->
            <li class="nav-item">
                <button type="button" class="nav-link active" role="tab" data-bs-toggle="tab" data-bs-target="#navs-pills-justified-home" aria-controls="navs-pills-justified-home" aria-selected="true">
                    <i class="tf-icons bx bx-home"></i> My Blogs
                    <span class="badge rounded-pill badge-center h-px-20 w-px-20 bg-danger">{{ blogs|length }}</span>
                </button>
            </li>
            <!-- Published Tab -->
            <li class="nav-item">
                <button type="button" class="nav-link" role="tab" data-bs-toggle="tab" data-bs-target="#navs-pills-justified-published" aria-controls="navs-pills-justified-published" aria-selected="false">
                    <i class="tf-icons bx bx-check"></i> Published
                    <span class="badge rounded-pill badge-center h-px-20 w-px-20 bg-danger">{{ published_blogs|length }}</span>
                </button>
            </li>
            <!-- Drafts Tab -->
            <li class="nav-item">
                <button type="button" class="nav-link" role="tab" data-bs-toggle="tab" data-bs-target="#navs-pills-justified-drafts" aria-controls="navs-pills-justified-drafts" aria-selected="false">
                    <i class="tf-icons bx bx-edit"></i> Drafts
                    <span class="badge rounded-pill badge-center h-px-20 w-px-20 bg-danger">{{ draft_blogs|length }}</span>
                </button>
            </li>
        </ul>
        <div class="tab-content" style="background-color:rgb(249, 229, 253);">
            <!-- My Blogs Tab Content -->
            <div class="tab-pane fade show active" id="navs-pills-justified-home" role="tabpanel">
                {% if blogs %}
                    {% for blog in blogs %}
                        <div class="col-md-12 mb-3">
                            <div class="card mb-5 {% if forloop.counter|divisibleby:2 %}card-right{% else %}card-left{% endif %}">
                                <div class="row g-0 {% if forloop.counter|divisibleby:2 %}flex-row-reverse{% endif %}">
                                    <div class="col-md-4">
                                        {% if blog.blog_image %}
                                            <img class="card-img" src="{{ blog.blog_image.url }}" alt="Blog image" />
                                        {% else %}
                                            <img class="card-img" src="{% static 'assets/img/elements/2.jpg' %}" alt="Default image" />
                                        {% endif %}
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card-body">
                                            <h5 class="card-title">{{ blog.title|default:"Blog Title" }}</h5>
                                            <p class="card-text">
                                                {{ blog.description|truncatewords:20|default:"Lorem ipsum dolor sit amet, consectetur adipiscing elit." }}
                                            </p>
                                            <p class="card-text"><small class="text-muted">Published on {{ blog.created_at|date:"F j, Y, g:i A" }}</small></p>
                                            <div class="d-flex justify-content-end mt-3">
                                                <a href="{% url 'view_blog' blog.id %}" class="btn btn-outline-primary btn-sm me-2">View</a>
                                                {% if user.is_authenticated and blog.author == user %}
                                                    <a href="{% url 'edit_blog' blog.id %}" class="btn btn-outline-primary btn-sm">Edit</a>
                                                    <form method="POST" action="{% url 'delete_blog' blog.id %}" style="display:inline;">
                                                        {% csrf_token %}
                                                        <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                                                    </form>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                  
                    {% endfor %}
                {% else %}
                    <p>No blogs available.</p>
                {% endif %}
            </div>
        
            <!-- Published Blogs Tab Content -->
            <div class="tab-pane fade" id="navs-pills-justified-published" role="tabpanel">
                {% if published_blogs %}
                    {% for blog in published_blogs %}
                        <div class="col-md-12 mb-3">
                            <div class="card mb-5 {% if forloop.counter|divisibleby:2 %}card-right{% else %}card-left{% endif %}">
                                <div class="row g-0 {% if forloop.counter|divisibleby:2 %}flex-row-reverse{% endif %}">
                                    <div class="col-md-4">
                                        {% if blog.blog_image %}
                                            <img class="card-img" src="{{ blog.blog_image.url }}" alt="Blog image" />
                                        {% else %}
                                            <img class="card-img" src="{% static 'assets/img/elements/2.jpg' %}" alt="Default image" />
                                        {% endif %}
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card-body">
                                            <h5 class="card-title">{{ blog.title|default:"Blog Title" }}</h5>
                                            <p class="card-text">
                                                {{ blog.description|truncatewords:20|default:"Lorem ipsum dolor sit amet, consectetur adipiscing elit." }}
                                            </p>
                                            <p class="card-text"><small class="text-muted">Published on {{ blog.created_at|date:"F j, Y, g:i A" }}</small></p>
                                            <div class="d-flex justify-content-end mt-3">
                                                <a href="{% url 'view_blog' blog.id %}" class="btn btn-outline-primary btn-sm me-2">View</a>
                                                {% if user.is_authenticated and blog.author == user %}
                                                    <a href="{% url 'edit_blog' blog.id %}" class="btn btn-outline-primary btn-sm">Edit</a>
                                                    <form method="POST" action="{% url 'delete_blog' blog.id %}" style="display:inline;">
                                                        {% csrf_token %}
                                                        <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                                                    </form>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                    {% endfor %}
                {% else %}
                    <p>No published blogs available.</p>
                {% endif %}
            </div>
        
            <!-- Draft Blogs Tab Content -->
            <div class="tab-pane fade" id="navs-pills-justified-drafts" role="tabpanel">
                {% if draft_blogs %}
                    {% for blog in draft_blogs %}
                        <div class="col-md-12 mb-3">
                            <div class="card mb-5 {% if forloop.counter|divisibleby:2 %}card-right{% else %}card-left{% endif %}">
                                <div class="row g-0 {% if forloop.counter|divisibleby:2 %}flex-row-reverse{% endif %}">
                                    <div class="col-md-4">
                                        {% if blog.blog_image %}
                                            <img class="card-img" src="{{ blog.blog_image.url }}" alt="Blog image" />
                                        {% else %}
                                            <img class="card-img" src="{% static 'assets/img/elements/2.jpg' %}" alt="Default image" />
                                        {% endif %}
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card-body">
                                            <h5 class="card-title">{{ blog.title|default:"Blog Title" }}</h5>
                                            <p class="card-text">
                                                {{ blog.description|truncatewords:20|default:"Lorem ipsum dolor sit amet, consectetur adipiscing elit." }}
                                            </p>
                                            <p class="card-text"><small class="text-muted">Created on {{ blog.created_at|date:"F j, Y, g:i A" }}</small></p>
                                            <div class="d-flex justify-content-end mt-3">
                                                <a href="{% url 'view_blog' blog.id %}" class="btn btn-outline-primary btn-sm me-2">View</a>
                                                {% if user.is_authenticated and blog.author == user %}
                                                    <a href="{% url 'edit_blog' blog.id %}" class="btn btn-outline-primary btn-sm">Edit</a>
                                                    <form method="POST" action="{% url 'delete_blog' blog.id %}" style="display:inline;">
                                                        {% csrf_token %}
                                                        <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                                                    </form>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                    {% endfor %}
                {% else %}
                    <p>No draft blogs available.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>


<style>
    .card {
        margin: 0 auto; /* Center the card */
        max-width: 800px; /* Set a smaller maximum width */
        padding: 10px; /* Reduce the padding */
    }
    .col-md-12:nth-child(odd) .card {
    margin-left: 0; /* Align the card to the left */
    margin-right: auto;
}

/* Right-aligned for even blogs */
.col-md-12:nth-child(even) .card {
    margin-left: auto;
    margin-right: 0; 
}
    .card-img {
        width: 100%;
        height: 150px; /* Reduce image height to make the cards smaller */
        object-fit: cover;
    }

    .card-body {
        padding: 0.75rem; /* Reduce padding inside the card body */
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
    }

    .card-title {
        font-size: 1.1rem; /* Slightly smaller title font size */
        margin-bottom: 0.3rem;
    }

    .card-text {
        font-size: 0.9rem; /* Reduce font size for the description */
        margin-bottom: 0.5rem;
        max-height: 60px; /* Decrease max height for content */
        overflow: hidden;
        text-overflow: ellipsis;
        line-height: 1.3;
    }

    .btn-custom {
        font-size: 0.7rem; /* Make buttons smaller */
        padding: 0.2rem 0.4rem;
        border-radius: 0.2rem;
        width: auto;
        white-space: nowrap;
        text-align: center;
    }

    .btn-group {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
        margin-top: 0.75rem; /* Reduce spacing between buttons */
    }

    .col-md-4 {
        max-width: 200px; /* Set a smaller width for image column */
    }

    .col-md-8 {
        max-width: calc(100% - 200px); /* Adjust the content width accordingly */
    }
</style>

    {% endblock %}